"use strict";var _createClass=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Sidebar=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this.config=$.extend({collapsedClass:"is-collapsed",storageKey:"_sassdoc_sidebar_index",indexAttribute:"data-slug",toggleBtn:".js-btn-toggle",init:!0},t),!0===this.config.init&&this.init()}return _createClass(e,[{key:"init",value:function(){this.config.nodes=$("["+this.config.indexAttribute+"]"),this.load(),this.updateDOM(),this.bind(),this.loadToggle()}},{key:"loadToggle",value:function(){$("<span />",{class:"layout-toggle",html:"&times;","data-alt":"&#8594;"}).appendTo($(".header"));var i=$(".layout-toggle");i.on("click",function(t){var e=$(t.target).closest(i);$("body").toggleClass("sidebar-closed");var n=e.html();e.html(e.data("alt")),e.data("alt",n)})}},{key:"load",value:function(){var t=window.localStorage?window.localStorage.getItem(this.config.storageKey):null;this.index=t?JSON.parse(t):this.buildIndex()}},{key:"buildIndex",value:function(){var i={};return this.config.nodes.each($.proxy(function(t,e){var n=$(e);i[n.attr(this.config.indexAttribute)]=!n.hasClass(this.config.collapsedClass)},this)),i}},{key:"updateDOM",value:function(){for(var t in this.index)!1===this.index[t]&&$("["+this.config.indexAttribute+'="'+t+'"]').addClass(this.config.collapsedClass)}},{key:"save",value:function(){window.localStorage&&window.localStorage.setItem(this.config.storageKey,JSON.stringify(this.index))}},{key:"bind",value:function(){var a=this,s=!1;window.onbeforeunload=$.proxy(function(){return a.save()},this),$(this.config.toggleBtn).on("click",$.proxy(function(t){var e=$(t.target),n=e.attr("data-alt");e.attr("data-alt",e.text()),e.text(n);var i=!0===s?"removeClass":"addClass";a.config.nodes.each($.proxy(function(t,e){var n=$(e).attr(this.config.indexAttribute);this.index[n]=s,$("["+this.config.indexAttribute+'="'+n+'"]')[i](this.config.collapsedClass)},a)),s=!s,a.save()},this)),this.config.nodes.on("click",$.proxy(function(t){var e=$(t.target),n=e.attr(a.config.indexAttribute);a.index[n]=!a.index[n],e.toggleClass(a.config.collapsedClass)},this))}}]),e}(),Search=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this.config=$.extend({search:{items:".sassdoc__item",input:"#js-search-input",form:"#js-search",suggestionsWrapper:"#js-search-suggestions"},fuse:{keys:["name"],threshold:.3},init:!0},t),!0===this.config.init&&this.init()}return _createClass(e,[{key:"init",value:function(){this.index=new Fuse($.map($(this.config.search.items),function(t){var e=$(t);return{group:e.data("group"),name:e.data("name"),type:e.data("type"),node:e}}),this.config.fuse),this.initSearch()}},{key:"fillSuggestions",value:function(t){var n=$(this.config.search.suggestionsWrapper);return n.html(""),$.map(t.slice(0,10),function(t){var e=$("<li />",{"data-group":t.group,"data-type":t.type,"data-name":t.name,html:'<a href="#'+t.group+"-"+t.type+"-"+t.name+'"><code>'+t.type.slice(0,3)+"</code>"+t.name+"</a>"});return n.append(e),e})}},{key:"search",value:function(t){return this.fillSuggestions(this.index.search(t))}},{key:"initSearch",value:function(){var e,t=$(this.config.search.form),n=$(this.config.search.input),i=$(this.config.search.suggestionsWrapper),a=-1,s=[],o=this;i.on("click",function(t){var e=$(event.target);"A"===e.nodeName&&(n.val(e.parent().data("name")),s=o.fillSuggestions([]))}),t.on("keyup",function(t){t.preventDefault(),13===t.keyCode&&(e&&(s=o.fillSuggestions([]),n.val(e.data("name")),window.location=e.children().first().attr("href")),t.stopPropagation()),40===t.keyCode&&(a=(a+1)%s.length),38===t.keyCode&&(a-=1)<0&&(a=s.length-1),s[a]&&(e&&e.removeClass("selected"),(e=s[a]).addClass("selected"))}),n.on("keyup",function(t){40!==t.keyCode&&38!==t.keyCode?(a=-1,s=o.search($(n).val())):t.preventDefault()}).on("search",function(){s=o.search($(n).val())})}}]),e}(),App=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this.config=$.extend({search:new Search,sidebar:new Sidebar,indentSpaces:!0,indentSize:2,indentUp:["{","("],indentDown:["}",")"],indentClass:"js-autoindent",init:!0},t),this.__lastChar=function(t){return t.trim()[t.trim().length-1]||""},!(this.__firstChar=function(t){return t.trim()[0]||""})!==this.config.init&&this.init()}return _createClass(e,[{key:"init",value:function(){this.codePreview()}},{key:"autoIndent",value:function(t){var o=this;t=t.split(/\r?\n/);var r=this.config.indentSpaces?" ".repeat(this.config.indentSize):"\t",c=t[0].search(/\S/)/r.length,l=t[0]?this.__lastChar(t[0]):"",d=t[1]?this.__firstChar(t[1]):"";return t.map(function(t,e,n){var i=t.trim(),a=c;0!==e&&(o.config.indentUp.includes(l)&&++a,o.config.indentDown.includes(d)&&--a);var s=r.repeat(a);return c=a,l=o.__lastChar(i),d=n[e+1]?o.__firstChar(n[e+1]):"",""+s+i},this).join("\n")}},{key:"codePreview",value:function(){var a=this,t=$("."+this.config.indentClass),s=$(".item__code--togglable");t.each(function(t,e){var n=$(e).is("code")?$(e):$(e).find("code");n.html(a.autoIndent(n.html()))}).bind(this),s.on("click",function(){var t=$(event.target).closest(s),e=t.find("code"),n="expanded"===t.attr("data-current-state")?"collapsed":"expanded",i=a.autoIndent(t.attr("data-"+n));t.attr("data-current-state",n),e.html(i),Prism.highlightElement(e[0])})}}]),e}(),app=new App;